
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>BMW Showroom — Enhanced</title>

<!-- GSAP CDN -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>

<style>
  :root{
    --bg:#0f1720; --card:#0f1728; --muted:#9aa4b2; --accent:#007bff; --glass: rgba(255,255,255,0.04);
  }
  .light { --bg:#f5f7fb; --card:#ffffff; --muted:#445; --accent:#0066cc; --glass: rgba(0,0,0,0.03); color:#111;}
  body{ margin:0; font-family:Inter,Segoe UI, Roboto, Arial; background:var(--bg); color: #fff; transition: background .3s, color .3s; }
  .container{width:96%;max-width:1200px;margin:30px auto;padding-bottom:60px;}

  /* top controls */
  .topbar{display:flex;align-items:center;justify-content:space-between;gap:10px;padding:10px 0}
  .brand{font-weight:700;font-size:20px}
  .controls{display:flex;gap:10px;align-items:center}
  .btn{background:var(--accent);color:#fff;border:none;padding:8px 12px;border-radius:8px;cursor:pointer}
  .muted{color:var(--muted);font-size:14px}

  /* hero with video */
  .hero{position:relative;height:320px;border-radius:12px;overflow:hidden;margin-bottom:24px}
  .hero video{position:absolute;left:0;top:0;width:100%;height:100%;object-fit:cover;filter:brightness(.45)}
  .hero .overlay{position:relative;z-index:2;padding:28px;color:#fff}
  .hero h1{margin:0;font-size:34px}
  .hero p{margin:6px 0 0;color:var(--muted)}

  /* gallery slider (horizontal) */
  .slider{display:flex;gap:16px;overflow-x:auto;padding:16px 0}
  .slider img{height:160px;border-radius:10px;box-shadow:0 6px 18px rgba(0,0,0,.35)}

  /* models grid */
  .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:18px;margin-top:20px}
  .card{background:var(--card);border-radius:12px;padding:12px;box-shadow:0 6px 20px rgba(0,0,0,.35);transition:transform .25s}
  .card:hover{transform:translateY(-6px)}
  .card img{width:100%;border-radius:8px}
  .card h3{margin:10px 0 6px}
  .specs{font-size:13px;color:var(--muted);display:flex;justify-content:space-between}

  /* compare box */
  .compare{background:var(--card);padding:14px;border-radius:10px;margin-top:22px}
  table{width:100%;border-collapse:collapse}
  th,td{padding:10px;border-bottom:1px solid rgba(255,255,255,0.06);text-align:left;font-size:14px}
  .small{font-size:13px;color:var(--muted)}

  /* 360 rotator demo */
  .rotator-wrap{margin:30px auto;width:100%;max-width:1000px;perspective:1200px}
  .rotator{width:680px;height:340px;margin:0 auto;position:relative;transform-style:preserve-3d;transition:transform .1s;touch-action:none}
  .rotator .face{position:absolute;left:50%;top:50%;transform-origin:center center;transform-style:preserve-3d}
  .rotator .face img{width:260px;height:160px;object-fit:cover;border-radius:8px;box-shadow:0 14px 40px rgba(0,0,0,.5)}
  .rotate-hint{ text-align:center;margin-top:8px;color:var(--muted) }

  /* booking modal */
  .modal{position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;align-items:center;justify-content:center;z-index:9999}
  .modal.open{display:flex}
  .modal .box{background:var(--card);padding:18px;border-radius:12px;width:420px}
  .field{display:flex;flex-direction:column;margin-bottom:8px}
  .field label{font-size:13px;margin-bottom:6px;color:var(--muted)}
  .field input, .field select, .field textarea{padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:inherit}

  /* small utilities */
  .row{display:flex;gap:10px;align-items:center}
  input.search{padding:8px 12px;border-radius:10px;border:1px solid rgba(255,255,255,0.06);width:260px;background:transparent;color:inherit}
  .filters{display:flex;gap:8px;align-items:center}
  .audio-btn{background:#222;border-radius:8px;padding:6px 8px;border:1px solid rgba(255,255,255,0.04);cursor:pointer;color:var(--muted)}

  /* reveal animation helper */
  .reveal{opacity:0;transform:translateY(12px)}
  .reveal.visible{opacity:1;transform:none;transition:all .7s cubic-bezier(.2,.9,.2,1)}

  @media(max-width:720px){
    .rotator{width:100%;height:260px}
    .rotator .face img{width:200px;height:120px}
    .hero h1{font-size:24px}
  }
</style>
</head>
<body id="page" class="">
  <div class="container">
    <div class="topbar">
      <div class="brand">BMW Showroom — Seshat</div>
      <div class="controls">
        <div class="muted">Preview Demo</div>
        <button class="btn" id="openBooking">Book Test Drive</button>
        <button class="btn" id="toggleMode">Toggle Light/Dark</button>
      </div>
    </div>

    <!-- HERO -->
    <div class="hero reveal">
      <video autoplay muted loop playsinline>
        <source src="https://cdn.pixabay.com/video/2023/01/18/146267-794764885_large.mp4" type="video/mp4">
      </video>
      <div class="overlay">
        <h1>BMW — The Ultimate Driving Machine</h1>
        <p>Explore latest models, specs, & book a test drive</p>
      </div>
    </div>

    <!-- Slider -->
    <h2 class="reveal">Gallery</h2>
    <div class="slider reveal" id="gallery">
      <img src="https://cdn.pixabay.com/photo/2017/03/27/14/56/bmw-2173982_1280.jpg" alt="">
      <img src="https://cdn.pixabay.com/photo/2018/03/01/09/33/bmw-3189930_1280.jpg" alt="">
      <img src="https://cdn.pixabay.com/photo/2016/11/22/19/25/bmw-1854737_1280.jpg" alt="">
      <img src="https://cdn.pixabay.com/photo/2016/11/21/14/50/auto-1844507_1280.jpg" alt="">
    </div>

    <!-- search & filters -->
    <div style="display:flex;justify-content:space-between;align-items:center;gap:12px" class="reveal">
      <div class="row">
        <input class="search" id="searchInput" placeholder="Search model (e.g., M3, i8, X5)"/>
        <div class="filters">
          <select id="typeFilter">
            <option value="">All Types</option>
            <option value="sedan">Sedan</option>
            <option value="coupe">Coupe</option>
            <option value="suv">SUV</option>
            <option value="hybrid">Hybrid</option>
          </select>
          <button class="btn" id="clearFilters">Clear</button>
        </div>
      </div>

      <div class="row small">
        <label style="margin-right:8px">Bookings saved:</label><span id="bookingCount">0</span>
      </div>
    </div>

    <!-- 360 Rotator -->
    <div class="rotator-wrap reveal" id="rotWrap">
      <div class="rotator" id="rotator"></div>
      <div class="rotate-hint small">Drag left/right to rotate the car (360° demo)</div>
    </div>

    <!-- Models grid -->
    <div class="grid reveal" id="modelGrid">
      <!-- Sample cards (data attributes for filtering) -->
      <div class="card" data-model="M3" data-type="sedan" data-price="72000">
        <img src="https://cdn.pixabay.com/photo/2017/01/06/19/15/bmw-1957031_1280.jpg" alt="">
        <h3>BMW M3</h3>
        <div class="specs"><span>473 HP</span><span>0-100 4.2s</span></div>
        <div style="margin-top:8px;display:flex;gap:8px;align-items:center">
          <button class="btn bookBtn">Book</button>
          <button class="audio-btn play" data-audio="https://cdn.pixabay.com/download/audio/2021/08/04/audio_8ad4d0c467.mp3?filename=sport-car-acceleration-8083.mp3">Play Sound</button>
          <span class="small" style="margin-left:auto">$72,000</span>
        </div>
      </div>

      <div class="card" data-model="M4" data-type="coupe" data-price="75000">
        <img src="https://cdn.pixabay.com/photo/2016/11/22/19/25/bmw-1854737_1280.jpg" alt="">
        <h3>BMW M4</h3>
        <div class="specs"><span>503 HP</span><span>0-100 3.9s</span></div>
        <div style="margin-top:8px;display:flex;gap:8px;align-items:center">
          <button class="btn bookBtn">Book</button>
          <button class="audio-btn play" data-audio="https://cdn.pixabay.com/download/audio/2021/08/04/audio_8ad4d0c467.mp3?filename=sport-car-acceleration-8083.mp3">Play Sound</button>
          <span class="small" style="margin-left:auto">$75,000</span>
        </div>
      </div>

      <div class="card" data-model="i8" data-type="hybrid" data-price="140000">
        <img src="https://cdn.pixabay.com/photo/2020/05/09/09/37/bmw-5149407_1280.jpg" alt="">
        <h3>BMW i8</h3>
        <div class="specs"><span>369 HP</span><span>Hybrid</span></div>
        <div style="margin-top:8px;display:flex;gap:8px;align-items:center">
          <button class="btn bookBtn">Book</button>
          <button class="audio-btn play" data-audio="https://cdn.pixabay.com/download/audio/2021/08/04/audio_8ad4d0c467.mp3?filename=sport-car-acceleration-8083.mp3">Play Sound</button>
          <span class="small" style="margin-left:auto">$140,000</span>
        </div>
      </div>

      <div class="card" data-model="X5" data-type="suv" data-price="85000">
        <img src="https://cdn.pixabay.com/photo/2016/11/21/14/50/auto-1844507_1280.jpg" alt="">
        <h3>BMW X5</h3>
        <div class="specs"><span>456 HP</span><span>Luxury SUV</span></div>
        <div style="margin-top:8px;display:flex;gap:8px;align-items:center">
          <button class="btn bookBtn">Book</button>
          <button class="audio-btn play" data-audio="https://cdn.pixabay.com/download/audio/2021/08/04/audio_8ad4d0c467.mp3?filename=sport-car-acceleration-8083.mp3">Play Sound</button>
          <span class="small" style="margin-left:auto">$85,000</span>
        </div>
      </div>
    </div>

    <!-- compare box -->
    <div class="compare reveal" id="compareBox">
      <h3>Compare Models</h3>
      <p class="small">Select up to 2 models from grid (click title) to compare.</p>
      <table id="compareTable">
        <thead><tr><th>Model</th><th>Price</th><th>Power</th><th>0-100</th></tr></thead>
        <tbody><tr><td colspan="4" class="small">No models selected</td></tr></tbody>
      </table>
    </div>

    <!-- bookings storage actions -->
    <div style="margin-top:18px;display:flex;gap:8px" class="reveal">
      <button class="btn" id="exportBookings">Export Bookings (CSV)</button>
      <button class="btn" id="clearBookings">Clear Bookings</button>
    </div>

    <div style="height:80px"></div>
  </div>

  <!-- Booking modal -->
  <div class="modal" id="modal">
    <div class="box">
      <h3>Book Test Drive</h3>
      <div class="field"><label>Name</label><input id="bk_name" /></div>
      <div class="field"><label>Phone</label><input id="bk_phone" /></div>
      <div class="field"><label>Model</label>
        <select id="bk_model">
          <option>M3</option><option>M4</option><option>i8</option><option>X5</option>
        </select>
      </div>
      <div class="field"><label>Date</label><input type="date" id="bk_date"/></div>
      <div style="display:flex;justify-content:space-between;gap:8px">
        <button class="btn" id="saveBooking">Save Booking</button>
        <button class="btn" id="closeModal">Cancel</button>
      </div>
      <div style="margin-top:8px;font-size:13px;color:var(--muted)">Bookings are saved locally in your browser (localStorage).</div>
    </div>
  </div>

<script>
/* ----------------- Utilities ----------------- */
function $(s){return document.querySelector(s)}
function $all(s){return Array.from(document.querySelectorAll(s))}

/* ----------------- Dark/Light mode (persist) ----------------- */
const root = document.getElementById('page')
const saved = localStorage.getItem('bmw_mode') || 'dark'
if(saved === 'light') document.body.classList.add('light')

$('#toggleMode').addEventListener('click', ()=>{
  document.body.classList.toggle('light')
  localStorage.setItem('bmw_mode', document.body.classList.contains('light')? 'light':'dark')
})

/* ----------------- Booking modal + storage ----------------- */
const modal = $('#modal')
$('#openBooking').addEventListener('click', ()=> modal.classList.add('open'))
$('#closeModal').addEventListener('click', ()=> modal.classList.remove('open'))

function loadBookings(){
  const data = JSON.parse(localStorage.getItem('bmw_bookings') || '[]')
  $('#bookingCount').innerText = data.length
  return data
}
function saveBooking(obj){
  const arr = loadBookings()
  arr.push(obj)
  localStorage.setItem('bmw_bookings', JSON.stringify(arr))
  $('#bookingCount').innerText = arr.length
}

/* save action */
$('#saveBooking').addEventListener('click', ()=>{
  const name = $('#bk_name').value.trim()
  const phone = $('#bk_phone').value.trim()
  const model = $('#bk_model').value
  const date = $('#bk_date').value
  if(!name || !phone || !date){ alert('Please fill all fields'); return; }
  saveBooking({name, phone, model, date, ts:Date.now()})
  alert('Booking saved locally ✅')
  modal.classList.remove('open')
})

$('#exportBookings').addEventListener('click', ()=>{
  const data = loadBookings()
  if(data.length===0){ alert('No bookings to export'); return; }
  const csv = ['name,phone,model,date'].concat(data.map(r=>`${r.name},${r.phone},${r.model},${r.date}`)).join('\\n')
  const blob = new Blob([csv], {type:'text/csv'})
  const url = URL.createObjectURL(blob)
  const a = document.createElement('a'); a.href=url; a.download='bookings.csv'; a.click(); URL.revokeObjectURL(url)
})

$('#clearBookings').addEventListener('click', ()=>{
  if(confirm('Clear all saved bookings?')){ localStorage.removeItem('bmw_bookings'); $('#bookingCount').innerText=0; }
})

/* ----------------- Play sounds (one-at-a-time) ----------------- */
let currentAudio = null
$all('.audio-btn.play').forEach(btn=>{
  btn.addEventListener('click', ()=>{
    const src = btn.dataset.audio
    if(currentAudio){ currentAudio.pause(); currentAudio = null; }
    if(!btn.dataset.playing){
      const audio = new Audio(src); currentAudio = audio
      audio.play(); btn.dataset.playing = '1'; btn.innerText = 'Pause'
      audio.onended = ()=>{ btn.innerText='Play Sound'; delete btn.dataset.playing }
    } else {
      currentAudio.pause(); delete btn.dataset.playing; btn.innerText='Play Sound'
    }
  })
})

/* ----------------- Compare selection ----------------- */
let selectedCompare = []
function updateCompare(){
  const tbody = $('#compareTable tbody'); tbody.innerHTML = ''
  if(selectedCompare.length===0){
    tbody.innerHTML = '<tr><td colspan="4" class="small">No models selected</td></tr>'; return
  }
  selectedCompare.slice(0,2).forEach(card=>{
    const model = card.dataset.model
    const price = card.dataset.price
    const power = card.querySelector('.specs span:first-child').innerText
    const zto = card.querySelector('.specs span:last-child').innerText
    const tr = document.createElement('tr')
    tr.innerHTML = `<td>${model}</td><td>$${price}</td><td>${power}</td><td>${zto}</td>`
    tbody.appendChild(tr)
  })
}
$all('.card h3').forEach(h=>{
  h.style.cursor='pointer'
  h.addEventListener('click', ()=>{
    const card = h.closest('.card')
    if(selectedCompare.includes(card)){
      selectedCompare = selectedCompare.filter(c=>c!==card)
      card.style.outline=''
    } else {
      if(selectedCompare.length<2) { selectedCompare.push(card); card.style.outline='3px solid var(--accent)'; }
      else { alert('You can select up to 2 models for compare') }
    }
    updateCompare()
  })
})

/* ----------------- Book buttons in cards (open modal + preselect model) ----------------- */
$all('.bookBtn').forEach(b=>{
  b.addEventListener('click', ()=>{
    const card = b.closest('.card')
    $('#bk_model').value = card.dataset.model
    modal.classList.add('open')
  })
})

/* ----------------- Search & Filters ----------------- */
$('#searchInput').addEventListener('input', ()=> applyFilters())
$('#typeFilter').addEventListener('change', ()=> applyFilters())
$('#clearFilters').addEventListener('click', ()=>{ $('#searchInput').value=''; $('#typeFilter').value=''; applyFilters() })

function applyFilters(){
  const q = $('#searchInput').value.trim().toLowerCase()
  const type = $('#typeFilter').value
  $all('#modelGrid .card').forEach(card=>{
    const model = card.dataset.model.toLowerCase()
    const t = card.dataset.type
    const visible = ( (!q || model.includes(q)) && (!type || t===type) )
    card.style.display = visible? 'block':'none'
  })
}

/* ----------------- 360 Rotator Setup (cylinder of faces) ----------------- */
const rotator = $('#rotator')
const images = [
  'https://cdn.pixabay.com/photo/2017/03/27/14/56/bmw-2173982_1280.jpg',
  'https://cdn.pixabay.com/photo/2018/03/01/09/33/bmw-3189930_1280.jpg',
  'https://cdn.pixabay.com/photo/2016/11/22/19/25/bmw-1854737_1280.jpg',
  'https://cdn.pixabay.com/photo/2016/11/21/14/50/auto-1844507_1280.jpg'
]
// create multiple faces around circle
const faces = 12
for(let i=0;i<faces;i++){
  const el = document.createElement('div'); el.className='face'
  const img = document.createElement('img'); img.src = images[i % images.length]
  el.appendChild(img)
  const angle = i * (360 / faces)
  el.style.transform = `translate(-50%,-50%) rotateY(${angle}deg) translateZ(450px)`
  rotator.appendChild(el)
}
// drag to rotate
let dragging=false, startX=0, curY=0
rotator.addEventListener('pointerdown', e=>{ dragging=true; startX=e.clientX; rotator.setPointerCapture(e.pointerId) })
window.addEventListener('pointerup', e=>{ dragging=false; rotator.releasePointerCapture && rotator.releasePointerCapture(e.pointerId) })
window.addEventListener('pointermove', e=>{
  if(!dragging) return
  const dx = e.clientX - startX
  startX = e.clientX
  curY += dx * 0.3
  rotator.style.transform = `translateZ(-120px) rotateY(${curY}deg)`
})

/* ----------------- Reveal on scroll (IntersectionObserver + GSAP) ----------------- */
const obs = new IntersectionObserver(entries=>{
  entries.forEach(en=>{
    if(en.isIntersecting){ en.target.classList.add('visible'); gsap.fromTo(en.target,{y:20, opacity:0},{y:0,opacity:1,duration:0.8, ease:'power2.out'}) }
  })
},{threshold:0.12})
$all('.reveal').forEach(el=>obs.observe(el))

/* ----------------- Init counts & bookings load ----------------- */
document.addEventListener('DOMContentLoaded', ()=>{
  $('#bookingCount').innerText = loadBookings().length
  applyFilters()
})
</script>
</body>
</html>
